{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "from langchain_openai import AzureOpenAIEmbeddings\n",
    "import openai\n",
    "\n",
    "#azure_endpoint = os.environ[\"OPENAI_API_BASE\"],\n",
    "#openai_api_key = os.environ[\"AZURE_OPENAI_API_KEY\"]\n",
    "#openai.api_key = os.environ[\"OPENAI_API_KEY\"]\n",
    "\n",
    "# Set the environment variable\n",
    "#os.environ.pop('OPENAI_API_BASE',None)\n",
    "os.environ[\"AZURE_OPENAI_API_KEY\"] = \"8df1223485e84c97a419cc93fa9ca1af\"\n",
    "os.environ[\"AZURE_OPENAI_ENDPOINT\"] = \"https://genwizard-adm-brownfield.openai.azure.com/\"\n",
    "#%env OPENAI_API_KEY=\"8df1223485e84c97a419cc93fa9ca1af\"\n",
    "\n",
    "# Retrieve the value\n",
    "azure_endpoint = os.environ.get('AZURE_OPENAI_ENDPOINT')\n",
    "azure_openai_api_key = os.environ.get('AZURE_OPENAI_API_KEY')\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "def pretty_print_docs(docs):\n",
    "    print(f\"\\n{'-' * 100}\\n\".join([f\"Document {i+1}:\\n\" + d.page_content for i, d in enumerate(docs)]))\n",
    "\n",
    "   \n",
    "\n",
    "# Create an instance of AzureOpenAIEmbeddings with custom base URL\n",
    "#embedding = AzureOpenAIEmbeddings(azure_endpoint=azure_endpoint, openai_api_key=azure_openai_api_key,chunk_size=1)\n",
    "embedding = AzureOpenAIEmbeddings(chunk_size=1, model=\"text-embedding-3-large\")\n",
    "#openai_ef = embedding_functions.OpenAIEmbeddingFunction(\n",
    "#                api_key=\"8df1223485e84c97a419cc93fa9ca1af\",\n",
    " #               model_name=\"text-embedding-3-large\"\n",
    "  #          )\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.text_splitter import RecursiveCharacterTextSplitter\n",
    "from langchain.vectorstores import Chroma\n",
    "\n",
    "from langchain.schema import Document\n",
    "\n",
    "# Load blog post\n",
    "from langchain.document_loaders import TextLoader\n",
    "\n",
    "loader = TextLoader(\"./dogs.txt\")\n",
    "data = loader.load()\n",
    "loader = TextLoader(\"./restaurant.txt\")\n",
    "data2 = loader.load()\n",
    "\n",
    "docs = data + data2\n",
    "\n",
    "\n",
    "#text_splitter = RecursiveCharacterTextSplitter(chunk_size=120, chunk_overlap=10)\n",
    "#docs = text_splitter.split_documents(data)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2\n"
     ]
    }
   ],
   "source": [
    "vector1 = embedding.embed_query(\"How is the whether??\")\n",
    "vector2 = embedding.embed_query(\"What is the Name of the Dogschool?\")\n",
    "vector3 = embedding.embed_query(\"What food do you offer?\")\n",
    "\n",
    "data_vectors = [embedding.embed_query(doc.page_content) for doc in docs]\n",
    "print(len(data_vectors))\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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bt26VaI9NTUVx48fh62tbYnd5ZXNyMioxF//27Zte+aYlGexsLAocxf5gAEDsH//fixatAi1atXCq6++qvWyf/75Z436Tp48iRMnTqiX4ejoiA4dOmDlypVISEgoMf/jr5uFhQUAlPql7uXlBTc3NyxcuBD5+fnqU/rbtWuH69evY/v27XjppZc09rz17t0bd+7cwerVq0ssLzs7G48ePQIAvPnmmzAyMsL06dNLbH8hRIn39fMq3iaPn74OlPwMAkVfVGlpaRqHdRMSEtSHjYpVZO19+/aFJEkYNWoUbty4odW4q+I9CY+vWwhRrlN/u3XrhoKCAo1T+gsLC7UO3d26dcOff/6JkydPqtvu3bunMbbsabXn5eXh66+/LrHMp32GSlvGiRMn1IeZtNGnTx/cvXsX33zzDc6dO6dxSArQ/jVu1qwZvLy8sGjRohKfocfne9rnrFu3bigsLMTSpUs12hcuXAhJkrT6vfDk+00mk6n3qFfE90BV4J6basDHxwebNm1Cnz590LBhQ4SFhaFx48bIy8vDsWPHsG3bNvW9jAICAhAeHo5Vq1apd8+ePHkS69atQ69evRAaGqrz+v38/NChQwcEBQXBzs4Of/31F7Zv367VeBZtzJ07FwcPHkTLli0xePBg+Pn5ISUlBWfOnMGBAweQkpLy1HnPnTuHfv364dVXX0W7du1gZ2eHO3fuYN26dbh79y4WLVpU5bvMe/TogRkzZmDQoEFo3bo1Lly4gI0bNz71WhjaCgoKwpYtWxAREYHmzZvD0tISPXv2VE/v168fPv30U/z0008YMmQITExMtF62r68v2rZtiyFDhiA3N1cdkD799FN1n2XLlqFt27Zo0qQJBg8eDG9vbyQlJeH48eP4999/1dfxCQwMhJGREebNm4e0tDQoFAp07NgRjo6OAIqCzObNm9GkSRP1HoVmzZrBwsIC165dQ79+/TRqGzBgALZu3Yr//Oc/OHjwINq0aYPCwkJcuXIFW7duxb59+xAcHAwfHx/MmjULEyZMwM2bN9GrVy9YWVkhLi4OP/30Ez766CNERkY+9/YvFhgYiL59++Lrr79GWloaWrdujejoaMTGxpbo++6772LcuHF44403MHLkSGRlZWH58uWoV6+exkDViqzdwcEBXbt2xbZt22BjY6PVHzgNGjSAj48PIiMjcefOHSiVSvz4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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.metrics.pairwise import cosine_similarity\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "\n",
    "cosine_sims_1 = [cosine_similarity([vector1], [data_vector])[0][0] for data_vector in data_vectors]\n",
    "cosine_sims_2 = [cosine_similarity([vector2], [data_vector])[0][0] for data_vector in data_vectors]\n",
    "cosine_sims_3 = [cosine_similarity([vector3], [data_vector])[0][0] for data_vector in data_vectors]\n",
    "\n",
    "x = np.arange(len(data_vectors))\n",
    "\n",
    "plt.scatter(x, cosine_sims_1, label='Weather', alpha=0.7)\n",
    "plt.scatter(x, cosine_sims_2, label='Dogschool', alpha=0.7)\n",
    "plt.scatter(x, cosine_sims_3, label='Restaurant', alpha=0.7)\n",
    "\n",
    "plt.ylabel('Cosine Similarity')\n",
    "plt.title('Consine Similarity between query and data vectors')\n",
    "plt.legend()\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hepzibah.prema\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\onnxruntime\\capi\\onnxruntime_validation.py:26: UserWarning: Unsupported Windows version (11). ONNX Runtime supports Windows 10 and above, only.\n",
      "  warnings.warn(\n"
     ]
    }
   ],
   "source": [
    "from langchain.storage import InMemoryStore\n",
    "from langchain.retrievers import ParentDocumentRetriever\n",
    "\n",
    "child_splitter = RecursiveCharacterTextSplitter(chunk_size=120, chunk_overlap=20)\n",
    "parent_splitter = RecursiveCharacterTextSplitter(chunk_size=400, chunk_overlap=20)\n",
    "vectorstore = Chroma(\n",
    "    collection_name=\"full_documents\", embedding_function=embedding\n",
    ")\n",
    "store = InMemoryStore()\n",
    "retriever = ParentDocumentRetriever(\n",
    "    vectorstore=vectorstore,\n",
    "    docstore=store,\n",
    "    child_splitter=child_splitter,\n",
    "    parent_splitter=parent_splitter\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "retriever.add_documents(docs, ids=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Document(page_content='A1: The school is called \"Canine Academy\".', metadata={'doc_id': '36286fb3-6276-46d2-86c5-ed639ba2adad', 'source': './dogs.txt'}),\n",
       " Document(page_content='Fiktive Hundeschule: Canine Academy\\nQ1: What is the name of the dog training school?', metadata={'doc_id': '36286fb3-6276-46d2-86c5-ed639ba2adad', 'source': './dogs.txt'}),\n",
       " Document(page_content='Q3: What training programs are offered at Canine Academy?', metadata={'doc_id': '36286fb3-6276-46d2-86c5-ed639ba2adad', 'source': './dogs.txt'}),\n",
       " Document(page_content='Q9: What are the fees for the training courses at Canine Academy?', metadata={'doc_id': '6058ed05-f03c-4da4-ad44-c4c6e2464825', 'source': './dogs.txt'})]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vectorstore.similarity_search(\"What is the name of the dog school?\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Successfully retrieved relevant documents!\n",
      "[Document(page_content='Fiktive Hundeschule: Canine Academy\\nQ1: What is the name of the dog training school?\\nA1: The school is called \"Canine Academy\".\\n\\nQ2: Where is Canine Academy located?\\nA2: Canine Academy is located in the suburbs, near the community park.\\n\\nQ3: What training programs are offered at Canine Academy?\\nA3: They offer basic obedience, agility training, and advanced behavioral courses.', metadata={'source': './dogs.txt'}), Document(page_content=\"Q8: Is there a trial class or evaluation session available?\\nA8: Yes, they offer a free evaluation session to assess the dog's needs and training level.\\n\\nQ9: What are the fees for the training courses at Canine Academy?\\nA9: Fees vary based on the course, but they offer competitive rates and package deals.\", metadata={'source': './dogs.txt'})]\n"
     ]
    }
   ],
   "source": [
    "import time\n",
    "\n",
    "def get_relevant_documents_with_retry(retriever, query, max_retries=3, delay=1):\n",
    "    retries = 0\n",
    "    while retries < max_retries:\n",
    "        try:\n",
    "            relevant_docs = retriever.get_relevant_documents(query)\n",
    "            return relevant_docs\n",
    "        except Exception as e:\n",
    "            print(f\"Encountered exception: {e}. Retrying...\")\n",
    "            retries += 1\n",
    "            time.sleep(delay)\n",
    "    return None  # Return None if all retries fail\n",
    "\n",
    "# Example usage:\n",
    "query = \"What is the name of the dog school?\"\n",
    "try:\n",
    "    relevant_docs = get_relevant_documents_with_retry(retriever, query)\n",
    "    if relevant_docs is not None:\n",
    "        print(\"Successfully retrieved relevant documents!\")\n",
    "        print(relevant_docs)\n",
    "    else:\n",
    "        print(\"Failed to retrieve relevant documents after max retries.\")\n",
    "except Exception as e:\n",
    "    print(f\"Failed to retrieve relevant documents: {e}\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### MultiQueryRetriever\n",
    "\n",
    "Nuances in the question can lead to different results if the question does not capture the embeddings semantically well.\n",
    "MultiQueryRetriever creates variations of the question and thus goes against the database"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain_openai import ChatOpenAI\n",
    "from langchain.retrievers.multi_query import MultiQueryRetriever\n",
    "\n",
    "llm = ChatOpenAI(      \n",
    "         \n",
    "        openai_api_key=\"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\",\n",
    "        temperature=0,\n",
    "        max_tokens=800,\n",
    "        model_kwargs={\"top_p\": 0, \"frequency_penalty\": 0, \"presence_penalty\": 0},\n",
    "        \n",
    "    )\n",
    "\n",
    "\n",
    "retriever = MultiQueryRetriever.from_llm(\n",
    "    retriever=vectorstore.as_retriever(), llm=llm\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "6"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "unique_docs = retriever.get_relevant_documents(\"What is the name of the dog school?\")\n",
    "len(unique_docs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValidationError",
     "evalue": "1 validation error for LLMChain\noutput_parser\n  instance of BaseLLMOutputParser expected (type=type_error.arbitrary_type; expected_arbitrary_type=BaseLLMOutputParser)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValidationError\u001b[0m                           Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[14], line 21\u001b[0m\n\u001b[0;32m     10\u001b[0m QUERY_PROMPT \u001b[38;5;241m=\u001b[39m PromptTemplate(\n\u001b[0;32m     11\u001b[0m     input_variables\u001b[38;5;241m=\u001b[39m[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mquestion\u001b[39m\u001b[38;5;124m\"\u001b[39m],\n\u001b[0;32m     12\u001b[0m     template\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\"\"\u001b[39m\u001b[38;5;124mYou are an AI language model assistant. Your task is to generate five\u001b[39m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m     17\u001b[0m \u001b[38;5;124m    Original question: \u001b[39m\u001b[38;5;132;01m{question}\u001b[39;00m\u001b[38;5;124m\"\"\"\u001b[39m,\n\u001b[0;32m     18\u001b[0m )\n\u001b[0;32m     20\u001b[0m \u001b[38;5;66;03m# Initialize the language model chain with the prompt and output parser\u001b[39;00m\n\u001b[1;32m---> 21\u001b[0m llm_chain \u001b[38;5;241m=\u001b[39m \u001b[43mLLMChain\u001b[49m\u001b[43m(\u001b[49m\u001b[43mllm\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mllm\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mprompt\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mQUERY_PROMPT\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43moutput_parser\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mLineList\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m     23\u001b[0m \u001b[38;5;66;03m# Invoke the language model chain with the input question\u001b[39;00m\n\u001b[0;32m     24\u001b[0m response \u001b[38;5;241m=\u001b[39m llm_chain\u001b[38;5;241m.\u001b[39minvoke(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mWhat is the name of the dog school?\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain_core\\load\\serializable.py:120\u001b[0m, in \u001b[0;36mSerializable.__init__\u001b[1;34m(self, **kwargs)\u001b[0m\n\u001b[0;32m    119\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m__init__\u001b[39m(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs: Any) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m--> 120\u001b[0m     \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[38;5;21;43m__init__\u001b[39;49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    121\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_lc_kwargs \u001b[38;5;241m=\u001b[39m kwargs\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pydantic\\v1\\main.py:341\u001b[0m, in \u001b[0;36mBaseModel.__init__\u001b[1;34m(__pydantic_self__, **data)\u001b[0m\n\u001b[0;32m    339\u001b[0m values, fields_set, validation_error \u001b[38;5;241m=\u001b[39m validate_model(__pydantic_self__\u001b[38;5;241m.\u001b[39m\u001b[38;5;18m__class__\u001b[39m, data)\n\u001b[0;32m    340\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m validation_error:\n\u001b[1;32m--> 341\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m validation_error\n\u001b[0;32m    342\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m    343\u001b[0m     object_setattr(__pydantic_self__, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m__dict__\u001b[39m\u001b[38;5;124m'\u001b[39m, values)\n",
      "\u001b[1;31mValidationError\u001b[0m: 1 validation error for LLMChain\noutput_parser\n  instance of BaseLLMOutputParser expected (type=type_error.arbitrary_type; expected_arbitrary_type=BaseLLMOutputParser)"
     ]
    }
   ],
   "source": [
    "from typing import List\n",
    "from langchain.chains import LLMChain\n",
    "from langchain.prompts import PromptTemplate\n",
    "from pydantic import BaseModel, Field\n",
    "\n",
    "class LineList(BaseModel):\n",
    "    lines: List[str] = Field(description=\"Lines of text\")\n",
    "\n",
    "# Define a prompt template for the query\n",
    "QUERY_PROMPT = PromptTemplate(\n",
    "    input_variables=[\"question\"],\n",
    "    template=\"\"\"You are an AI language model assistant. Your task is to generate five\n",
    "    different versions of the given user question to retrieve relevant documents from a vector\n",
    "    database. By generating multiple perspectives on the user question, your goal is to help\n",
    "    the user overcome some of the limitations of the distance-based similarity search.\n",
    "    Provide these alternative questions separated by newlines.\n",
    "    Original question: {question}\"\"\",\n",
    ")\n",
    "\n",
    "# Initialize the language model chain with the prompt and output parser\n",
    "llm_chain = LLMChain(llm=llm, prompt=QUERY_PROMPT, output_parser=LineList)\n",
    "\n",
    "# Invoke the language model chain with the input question\n",
    "response = llm_chain.invoke(\"What is the name of the dog school?\")\n",
    "\n",
    "# Print the parsed response\n",
    "print(\"Parsed response:\")\n",
    "print(response.lines)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'llm_chain' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[15], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[43mllm_chain\u001b[49m\u001b[38;5;241m.\u001b[39minvoke(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mWhat is the name of the dog school?\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'llm_chain' is not defined"
     ]
    }
   ],
   "source": [
    "llm_chain.invoke(\"What is the name of the dog school?\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "question = \"What is the name of the dog school?\"\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Contextual Compression\n",
    "\n",
    "To use the Contextual Compression Retriever, you need:\n",
    "\n",
    "    a basic retriever\n",
    "    a document compressor\n",
    "\n",
    "The Contextual Compression Retriever passes queries to the Base Retriever, takes the source documents and forwards them to the Document Compressor. The document compressor takes a list of documents and shortens them by reducing the content of documents or omitting documents altogether."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "vectorstore = Chroma(\n",
    "    collection_name=\"full_documents\", embedding_function=embedding\n",
    ")\n",
    "vectorstore.add_documents(docs)\n",
    "retriever = vectorstore.as_retriever()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Document(page_content='A1: The school is called \"Canine Academy\".', metadata={'doc_id': '36286fb3-6276-46d2-86c5-ed639ba2adad', 'source': './dogs.txt'}),\n",
       " Document(page_content='Fiktive Hundeschule: Canine Academy\\nQ1: What is the name of the dog training school?', metadata={'doc_id': '36286fb3-6276-46d2-86c5-ed639ba2adad', 'source': './dogs.txt'}),\n",
       " Document(page_content='Fiktive Hundeschule: Canine Academy\\nQ1: What is the name of the dog training school?\\nA1: The school is called \"Canine Academy\".\\n\\nQ2: Where is Canine Academy located?\\nA2: Canine Academy is located in the suburbs, near the community park.\\n\\nQ3: What training programs are offered at Canine Academy?\\nA3: They offer basic obedience, agility training, and advanced behavioral courses.\\n\\nQ4: Are there any special qualifications for the trainers at Canine Academy?\\nA4: All trainers are certified and have years of experience in dog training and behavior.\\n\\nQ5: Can Canine Academy help with specific behavioral issues?\\nA5: Yes, they offer personalized training sessions for issues like aggression, anxiety, and barking.\\n\\nQ6: How long do the training courses last?\\nA6: The courses vary, ranging from 4-week short courses to 12-week intensive programs.\\n\\nQ7: Does Canine Academy provide training for service or therapy dogs?\\nA7: Yes, they have specialized programs for service and therapy dog training.\\n\\nQ8: Is there a trial class or evaluation session available?\\nA8: Yes, they offer a free evaluation session to assess the dog\\'s needs and training level.\\n\\nQ9: What are the fees for the training courses at Canine Academy?\\nA9: Fees vary based on the course, but they offer competitive rates and package deals.\\n\\nQ10: Does Canine Academy offer any support or follow-up after completion of a course?\\nA10: Yes, they provide follow-up consultations and support for continued training and development.', metadata={'source': './dogs.txt'}),\n",
       " Document(page_content='Q3: What training programs are offered at Canine Academy?', metadata={'doc_id': '36286fb3-6276-46d2-86c5-ed639ba2adad', 'source': './dogs.txt'})]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "retriever.get_relevant_documents(query=question)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\hepzibah.prema\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain\\chains\\llm.py:316: UserWarning: The predict_and_parse method is deprecated, instead pass an output parser directly to LLMChain.\n",
      "  warnings.warn(\n",
      "C:\\Users\\hepzibah.prema\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain\\chains\\llm.py:316: UserWarning: The predict_and_parse method is deprecated, instead pass an output parser directly to LLMChain.\n",
      "  warnings.warn(\n",
      "C:\\Users\\hepzibah.prema\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain\\chains\\llm.py:316: UserWarning: The predict_and_parse method is deprecated, instead pass an output parser directly to LLMChain.\n",
      "  warnings.warn(\n",
      "C:\\Users\\hepzibah.prema\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain\\chains\\llm.py:316: UserWarning: The predict_and_parse method is deprecated, instead pass an output parser directly to LLMChain.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Document 1:\n",
      "The school is called \"Canine Academy\".\n",
      "----------------------------------------------------------------------------------------------------\n",
      "Document 2:\n",
      "Fiktive Hundeschule: Canine Academy\n",
      "----------------------------------------------------------------------------------------------------\n",
      "Document 3:\n",
      "Fiktive Hundeschule: Canine Academy\n"
     ]
    }
   ],
   "source": [
    "from langchain.retrievers import ContextualCompressionRetriever\n",
    "from langchain.retrievers.document_compressors import LLMChainExtractor\n",
    "\n",
    "compressor = LLMChainExtractor.from_llm(llm)\n",
    "compression_retriever = ContextualCompressionRetriever(base_compressor=compressor, base_retriever=retriever)\n",
    "\n",
    "compressed_docs = compression_retriever.get_relevant_documents(query=question)\n",
    "pretty_print_docs(compressed_docs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Document 1:\n",
      "A1: The school is called \"Canine Academy\".\n",
      "----------------------------------------------------------------------------------------------------\n",
      "Document 2:\n",
      "Fiktive Hundeschule: Canine Academy\n",
      "Q1: What is the name of the dog training school?\n",
      "----------------------------------------------------------------------------------------------------\n",
      "Document 3:\n",
      "Fiktive Hundeschule: Canine Academy\n",
      "Q1: What is the name of the dog training school?\n",
      "A1: The school is called \"Canine Academy\".\n",
      "\n",
      "Q2: Where is Canine Academy located?\n",
      "A2: Canine Academy is located in the suburbs, near the community park.\n",
      "\n",
      "Q3: What training programs are offered at Canine Academy?\n",
      "A3: They offer basic obedience, agility training, and advanced behavioral courses.\n",
      "\n",
      "Q4: Are there any special qualifications for the trainers at Canine Academy?\n",
      "A4: All trainers are certified and have years of experience in dog training and behavior.\n",
      "\n",
      "Q5: Can Canine Academy help with specific behavioral issues?\n",
      "A5: Yes, they offer personalized training sessions for issues like aggression, anxiety, and barking.\n",
      "\n",
      "Q6: How long do the training courses last?\n",
      "A6: The courses vary, ranging from 4-week short courses to 12-week intensive programs.\n",
      "\n",
      "Q7: Does Canine Academy provide training for service or therapy dogs?\n",
      "A7: Yes, they have specialized programs for service and therapy dog training.\n",
      "\n",
      "Q8: Is there a trial class or evaluation session available?\n",
      "A8: Yes, they offer a free evaluation session to assess the dog's needs and training level.\n",
      "\n",
      "Q9: What are the fees for the training courses at Canine Academy?\n",
      "A9: Fees vary based on the course, but they offer competitive rates and package deals.\n",
      "\n",
      "Q10: Does Canine Academy offer any support or follow-up after completion of a course?\n",
      "A10: Yes, they provide follow-up consultations and support for continued training and development.\n",
      "----------------------------------------------------------------------------------------------------\n",
      "Document 4:\n",
      "Q3: What training programs are offered at Canine Academy?\n"
     ]
    }
   ],
   "source": [
    "from langchain.embeddings import OpenAIEmbeddings\n",
    "from langchain.retrievers.document_compressors import EmbeddingsFilter\n",
    "\n",
    "embeddings_filter = EmbeddingsFilter(embeddings=embedding, similarity_threshold=0.5)\n",
    "compression_retriever = ContextualCompressionRetriever(base_compressor=embeddings_filter, base_retriever=retriever)\n",
    "\n",
    "compressed_docs = compression_retriever.get_relevant_documents(query=question)\n",
    "pretty_print_docs(compressed_docs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "from langchain.document_transformers import EmbeddingsRedundantFilter\n",
    "from langchain.retrievers.document_compressors import DocumentCompressorPipeline\n",
    "from langchain.text_splitter import CharacterTextSplitter\n",
    "\n",
    "splitter = CharacterTextSplitter(chunk_size=300, chunk_overlap=0, separator=\". \")\n",
    "redundant_filter = EmbeddingsRedundantFilter(embeddings=embedding)\n",
    "relevant_filter = EmbeddingsFilter(embeddings=embedding, similarity_threshold=0.76)\n",
    "pipeline_compressor = DocumentCompressorPipeline(\n",
    "    transformers=[splitter, redundant_filter, relevant_filter]\n",
    ")\n",
    "\n",
    "compression_retriever = ContextualCompressionRetriever(base_compressor=pipeline_compressor, base_retriever=retriever)\n",
    "\n",
    "compressed_docs = compression_retriever.get_relevant_documents(query=question)\n",
    "pretty_print_docs(compressed_docs)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Ensemble Retriever"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.retrievers import BM25Retriever, EnsembleRetriever\n",
    "\n",
    "\n",
    "bm25_retriever = BM25Retriever.from_documents(docs)\n",
    "bm25_retriever.k = 2\n",
    "\n",
    "chroma_vectorstore = Chroma.from_documents(docs, embedding)\n",
    "chroma_retriever = chroma_vectorstore.as_retriever()\n",
    "\n",
    "ensemble_retriever = EnsembleRetriever(\n",
    "    retrievers=[bm25_retriever, chroma_retriever], weights=[0.5, 0.5]\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Number of requested results 4 is greater than number of elements in index 2, updating n_results = 2\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[Document(page_content='Fiktive Hundeschule: Canine Academy\\nQ1: What is the name of the dog training school?\\nA1: The school is called \"Canine Academy\".\\n\\nQ2: Where is Canine Academy located?\\nA2: Canine Academy is located in the suburbs, near the community park.\\n\\nQ3: What training programs are offered at Canine Academy?\\nA3: They offer basic obedience, agility training, and advanced behavioral courses.\\n\\nQ4: Are there any special qualifications for the trainers at Canine Academy?\\nA4: All trainers are certified and have years of experience in dog training and behavior.\\n\\nQ5: Can Canine Academy help with specific behavioral issues?\\nA5: Yes, they offer personalized training sessions for issues like aggression, anxiety, and barking.\\n\\nQ6: How long do the training courses last?\\nA6: The courses vary, ranging from 4-week short courses to 12-week intensive programs.\\n\\nQ7: Does Canine Academy provide training for service or therapy dogs?\\nA7: Yes, they have specialized programs for service and therapy dog training.\\n\\nQ8: Is there a trial class or evaluation session available?\\nA8: Yes, they offer a free evaluation session to assess the dog\\'s needs and training level.\\n\\nQ9: What are the fees for the training courses at Canine Academy?\\nA9: Fees vary based on the course, but they offer competitive rates and package deals.\\n\\nQ10: Does Canine Academy offer any support or follow-up after completion of a course?\\nA10: Yes, they provide follow-up consultations and support for continued training and development.', metadata={'source': './dogs.txt'}),\n",
       " Document(page_content='Fiktives Restaurant: Gourmet\\'s Delight\\nQ1: What is the name of the restaurant?\\nA1: The restaurant is named \"Gourmet\\'s Delight\".\\n\\nQ2: Where is Gourmet\\'s Delight located?\\nA2: It is located in the heart of downtown, on Maple Street.\\n\\nQ3: What type of cuisine does Gourmet\\'s Delight offer?\\nA3: Gourmet\\'s Delight specializes in a fusion of Mediterranean and Asian cuisine.\\n\\nQ4: Is the restaurant vegetarian-friendly?\\nA4: Yes, there is a wide range of vegetarian and vegan options available.\\n\\nQ5: Does Gourmet\\'s Delight accept reservations?\\nA5: Yes, guests are encouraged to make reservations, especially on weekends.\\n\\nQ6: Are there any special dishes that are recommended at Gourmet\\'s Delight?\\nA6: The signature dish is the \\'Medit-Asian Fusion Platter\\' which includes a variety of specialties.\\n\\nQ7: What are the operating hours of the restaurant?\\nA7: The restaurant is open from 11:00 AM to 10:00 PM, Monday through Sunday.\\n\\nQ8: Does Gourmet\\'s Delight offer any special promotions?\\nA8: Yes, there are happy hour discounts from 4:00 PM to 6:00 PM on weekdays.\\n\\nQ9: Can Gourmet\\'s Delight accommodate large parties or events?\\nA9: Yes, the restaurant has a private dining area that can be reserved for events and parties.', metadata={'source': './restaurant.txt'})]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "docs = ensemble_retriever.get_relevant_documents(query=question)\n",
    "docs"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Self-Querying retriever\n",
    "\n",
    "A self-querying retriever is a retriever that, as the name suggests, has the ability to \n",
    "the ability to query itself. More precisely, any natural language query,\n",
    " the retriever uses an LLM chain for query construction to write a structured query\n",
    " structured query and then applies this structured query to the underlying \n",
    "VectorStore. This allows the retriever to not only use the query entered by the user \n",
    "query for the semantic similarity comparison with the content of the stored \n",
    "documents, but also apply filters from the user query to the metadata of the stored \n",
    "metadata of the stored documents and execute these filters."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.schema import Document\n",
    "from langchain.vectorstores import Chroma\n",
    "\n",
    "docs = [\n",
    "    Document(\n",
    "        page_content=\"Bello-Basistraining offers a comprehensive foundation for dog obedience, focusing on basic commands and socialization.\",\n",
    "        metadata={\"type\": \"Basic Training\", \"feature\": \"Foundational Skills\", \"price\": \"Affordable\"},\n",
    "    ),\n",
    "    Document(\n",
    "        page_content=\"Pfote-Agilitykurs provides a fun and energetic way to keep dogs fit and mentally stimulated through obstacle courses.\",\n",
    "        metadata={\"type\": \"Agility Training\", \"feature\": \"Physical Fitness\", \"price\": \"Moderate\"},\n",
    "    ),\n",
    "    Document(\n",
    "        page_content=\"Wuff-Verhaltensberatung specializes in addressing behavioral issues, offering tailored strategies for each dog.\",\n",
    "        metadata={\"type\": \"Behavioral Consultation\", \"feature\": \"Customized Solutions\", \"price\": \"Premium\"},\n",
    "    ),\n",
    "    Document(\n",
    "        page_content=\"Schwanzwedeln-Therapiehundausbildung prepares dogs for roles in therapeutic and support settings, focusing on empathy and gentleness.\",\n",
    "        metadata={\"type\": \"Therapy Dog Training\", \"feature\": \"Emotional Support\", \"price\": \"High\"},\n",
    "    ),\n",
    "    Document(\n",
    "        page_content=\"Schnüffler-Suchhundetraining trains dogs in scent detection, useful for search and rescue operations.\",\n",
    "        metadata={\"type\": \"Search and Rescue Training\", \"feature\": \"Advanced Skills\", \"price\": \"Variable\"},\n",
    "    ),\n",
    "    Document(\n",
    "        page_content=\"Hunde-Haftpflichtversicherung offers comprehensive coverage for potential damages or injuries caused by your dog.\",\n",
    "        metadata={\"type\": \"Dog Liability Insurance\", \"feature\": \"Financial Protection\", \"price\": \"Varies\"},\n",
    "    ),\n",
    "]\n",
    "\n",
    "vectorstore = Chroma.from_documents(docs, embedding)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "from langchain.vectorstores import Chroma\n",
    "from langchain.chains.query_constructor.base import AttributeInfo\n",
    "from langchain.retrievers.self_query.base import SelfQueryRetriever\n",
    "\n",
    "metadata_field_info = [\n",
    "    AttributeInfo(\n",
    "        name=\"type\",\n",
    "        description=\"The type of dog training service (e.g., Basic Training, Agility Training, Behavioral Consultation)\",\n",
    "        type=\"string\",\n",
    "    ),\n",
    "    AttributeInfo(\n",
    "        name=\"feature\",\n",
    "        description=\"Special features or benefits of the service\",\n",
    "        type=\"string\",\n",
    "    ),\n",
    "    AttributeInfo(\n",
    "        name=\"price\",\n",
    "        description=\"Price category of the service (e.g., Affordable, Moderate, Premium)\",\n",
    "        type=\"string\",\n",
    "    ),\n",
    "]\n",
    "\n",
    "document_content_description = \"Description of a dog training service\"\n",
    "retriever = SelfQueryRetriever.from_llm(\n",
    "    llm,\n",
    "    vectorstore,\n",
    "    document_content_description,\n",
    "    metadata_field_info,\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Document(page_content='Wuff-Verhaltensberatung specializes in addressing behavioral issues, offering tailored strategies for each dog.', metadata={'feature': 'Customized Solutions', 'price': 'Premium', 'type': 'Behavioral Consultation'})]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "retriever.invoke(\"What Premium priced trainings do you offer?\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Time-weighted vector store retriever"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "import faiss\n",
    "\n",
    "from datetime import datetime, timedelta\n",
    "from langchain.docstore import InMemoryDocstore\n",
    "from langchain.embeddings import OpenAIEmbeddings\n",
    "from langchain.retrievers import TimeWeightedVectorStoreRetriever\n",
    "from langchain.schema import Document\n",
    "from langchain.vectorstores import FAISS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "# decay_rate = .0000000000000000000000001\n",
    "decay_rate = .999\n",
    "\n",
    "embedding_size = 1536\n",
    "index = faiss.IndexFlatL2(embedding_size)\n",
    "vectorstore = FAISS(embedding, index, InMemoryDocstore({}), {})\n",
    "retriever = TimeWeightedVectorStoreRetriever(vectorstore=vectorstore, decay_rate=decay_rate, k=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Error occurred: \n"
     ]
    }
   ],
   "source": [
    "import time\n",
    "from datetime import datetime, timedelta\n",
    "\n",
    "def call_openai_api_with_retry(api_function, *args, **kwargs):\n",
    "    max_retries = 5  # Adjust the maximum number of retries as needed\n",
    "    base_delay = 30  # seconds (adjust according to your preference)\n",
    "    retries = 0\n",
    "    while retries < max_retries:\n",
    "        try:\n",
    "            return api_function(*args, **kwargs)\n",
    "        except Exception as e:\n",
    "            if \"Rate limit reached\" in str(e):  # Check if the error message contains \"Rate limit reached\"\n",
    "                delay = base_delay * 2**retries\n",
    "                print(f\"Rate limit reached. Retrying in {delay} seconds...\")\n",
    "                time.sleep(delay)\n",
    "                retries += 1\n",
    "            else:\n",
    "                raise e\n",
    "    raise Exception(\"Max retries reached. Failed to call OpenAI API.\")\n",
    "\n",
    "# Usage example:\n",
    "yesterday = datetime.now() - timedelta(days=1)\n",
    "try:\n",
    "    retriever.add_documents([Document(page_content=\"hello world\", metadata={\"last_accessed_at\": yesterday})])\n",
    "    retriever.add_documents([Document(page_content=\"hello foo\")])\n",
    "except Exception as e:\n",
    "    print(f\"Error occurred: {e}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "ename": "AssertionError",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAssertionError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[41], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[43mretriever\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_relevant_documents\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mhello world\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain_core\\retrievers.py:245\u001b[0m, in \u001b[0;36mBaseRetriever.get_relevant_documents\u001b[1;34m(self, query, callbacks, tags, metadata, run_name, **kwargs)\u001b[0m\n\u001b[0;32m    243\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[0;32m    244\u001b[0m     run_manager\u001b[38;5;241m.\u001b[39mon_retriever_error(e)\n\u001b[1;32m--> 245\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m e\n\u001b[0;32m    246\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m    247\u001b[0m     run_manager\u001b[38;5;241m.\u001b[39mon_retriever_end(\n\u001b[0;32m    248\u001b[0m         result,\n\u001b[0;32m    249\u001b[0m     )\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain_core\\retrievers.py:238\u001b[0m, in \u001b[0;36mBaseRetriever.get_relevant_documents\u001b[1;34m(self, query, callbacks, tags, metadata, run_name, **kwargs)\u001b[0m\n\u001b[0;32m    236\u001b[0m _kwargs \u001b[38;5;241m=\u001b[39m kwargs \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_expects_other_args \u001b[38;5;28;01melse\u001b[39;00m {}\n\u001b[0;32m    237\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_new_arg_supported:\n\u001b[1;32m--> 238\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_get_relevant_documents\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    239\u001b[0m \u001b[43m        \u001b[49m\u001b[43mquery\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrun_manager\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mrun_manager\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43m_kwargs\u001b[49m\n\u001b[0;32m    240\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    241\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m    242\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_relevant_documents(query, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m_kwargs)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain\\retrievers\\time_weighted_retriever.py:137\u001b[0m, in \u001b[0;36mTimeWeightedVectorStoreRetriever._get_relevant_documents\u001b[1;34m(self, query, run_manager)\u001b[0m\n\u001b[0;32m    132\u001b[0m docs_and_scores \u001b[38;5;241m=\u001b[39m {\n\u001b[0;32m    133\u001b[0m     doc\u001b[38;5;241m.\u001b[39mmetadata[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mbuffer_idx\u001b[39m\u001b[38;5;124m\"\u001b[39m]: (doc, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_salience)\n\u001b[0;32m    134\u001b[0m     \u001b[38;5;28;01mfor\u001b[39;00m doc \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmemory_stream[\u001b[38;5;241m-\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mk :]\n\u001b[0;32m    135\u001b[0m }\n\u001b[0;32m    136\u001b[0m \u001b[38;5;66;03m# If a doc is considered salient, update the salience score\u001b[39;00m\n\u001b[1;32m--> 137\u001b[0m docs_and_scores\u001b[38;5;241m.\u001b[39mupdate(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_salient_docs\u001b[49m\u001b[43m(\u001b[49m\u001b[43mquery\u001b[49m\u001b[43m)\u001b[49m)\n\u001b[0;32m    138\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_rescored_docs(docs_and_scores)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain\\retrievers\\time_weighted_retriever.py:84\u001b[0m, in \u001b[0;36mTimeWeightedVectorStoreRetriever.get_salient_docs\u001b[1;34m(self, query)\u001b[0m\n\u001b[0;32m     82\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Return documents that are salient to the query.\"\"\"\u001b[39;00m\n\u001b[0;32m     83\u001b[0m docs_and_scores: List[Tuple[Document, \u001b[38;5;28mfloat\u001b[39m]]\n\u001b[1;32m---> 84\u001b[0m docs_and_scores \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mvectorstore\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimilarity_search_with_relevance_scores\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m     85\u001b[0m \u001b[43m    \u001b[49m\u001b[43mquery\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msearch_kwargs\u001b[49m\n\u001b[0;32m     86\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m     87\u001b[0m results \u001b[38;5;241m=\u001b[39m {}\n\u001b[0;32m     88\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m fetched_doc, relevance \u001b[38;5;129;01min\u001b[39;00m docs_and_scores:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain_core\\vectorstores.py:323\u001b[0m, in \u001b[0;36mVectorStore.similarity_search_with_relevance_scores\u001b[1;34m(self, query, k, **kwargs)\u001b[0m\n\u001b[0;32m    307\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Return docs and relevance scores in the range [0, 1].\u001b[39;00m\n\u001b[0;32m    308\u001b[0m \n\u001b[0;32m    309\u001b[0m \u001b[38;5;124;03m0 is dissimilar, 1 is most similar.\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    319\u001b[0m \u001b[38;5;124;03m    List of Tuples of (doc, similarity_score)\u001b[39;00m\n\u001b[0;32m    320\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    321\u001b[0m score_threshold \u001b[38;5;241m=\u001b[39m kwargs\u001b[38;5;241m.\u001b[39mpop(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mscore_threshold\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m)\n\u001b[1;32m--> 323\u001b[0m docs_and_similarities \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_similarity_search_with_relevance_scores\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    324\u001b[0m \u001b[43m    \u001b[49m\u001b[43mquery\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\n\u001b[0;32m    325\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    326\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28many\u001b[39m(\n\u001b[0;32m    327\u001b[0m     similarity \u001b[38;5;241m<\u001b[39m \u001b[38;5;241m0.0\u001b[39m \u001b[38;5;129;01mor\u001b[39;00m similarity \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1.0\u001b[39m\n\u001b[0;32m    328\u001b[0m     \u001b[38;5;28;01mfor\u001b[39;00m _, similarity \u001b[38;5;129;01min\u001b[39;00m docs_and_similarities\n\u001b[0;32m    329\u001b[0m ):\n\u001b[0;32m    330\u001b[0m     warnings\u001b[38;5;241m.\u001b[39mwarn(\n\u001b[0;32m    331\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mRelevance scores must be between\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    332\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m 0 and 1, got \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdocs_and_similarities\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    333\u001b[0m     )\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain_community\\vectorstores\\faiss.py:1159\u001b[0m, in \u001b[0;36mFAISS._similarity_search_with_relevance_scores\u001b[1;34m(self, query, k, filter, fetch_k, **kwargs)\u001b[0m\n\u001b[0;32m   1154\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m relevance_score_fn \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   1155\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m   1156\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mnormalize_score_fn must be provided to\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m   1157\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m FAISS constructor to normalize scores\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m   1158\u001b[0m     )\n\u001b[1;32m-> 1159\u001b[0m docs_and_scores \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimilarity_search_with_score\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m   1160\u001b[0m \u001b[43m    \u001b[49m\u001b[43mquery\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1161\u001b[0m \u001b[43m    \u001b[49m\u001b[43mk\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1162\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;28;43mfilter\u001b[39;49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mfilter\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1163\u001b[0m \u001b[43m    \u001b[49m\u001b[43mfetch_k\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mfetch_k\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1164\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1165\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1166\u001b[0m docs_and_rel_scores \u001b[38;5;241m=\u001b[39m [\n\u001b[0;32m   1167\u001b[0m     (doc, relevance_score_fn(score)) \u001b[38;5;28;01mfor\u001b[39;00m doc, score \u001b[38;5;129;01min\u001b[39;00m docs_and_scores\n\u001b[0;32m   1168\u001b[0m ]\n\u001b[0;32m   1169\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m docs_and_rel_scores\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain_community\\vectorstores\\faiss.py:403\u001b[0m, in \u001b[0;36mFAISS.similarity_search_with_score\u001b[1;34m(self, query, k, filter, fetch_k, **kwargs)\u001b[0m\n\u001b[0;32m    386\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Return docs most similar to query.\u001b[39;00m\n\u001b[0;32m    387\u001b[0m \n\u001b[0;32m    388\u001b[0m \u001b[38;5;124;03mArgs:\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    400\u001b[0m \u001b[38;5;124;03m    L2 distance in float. Lower score represents more similarity.\u001b[39;00m\n\u001b[0;32m    401\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    402\u001b[0m embedding \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_embed_query(query)\n\u001b[1;32m--> 403\u001b[0m docs \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimilarity_search_with_score_by_vector\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    404\u001b[0m \u001b[43m    \u001b[49m\u001b[43membedding\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    405\u001b[0m \u001b[43m    \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    406\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;28;43mfilter\u001b[39;49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mfilter\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[0;32m    407\u001b[0m \u001b[43m    \u001b[49m\u001b[43mfetch_k\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mfetch_k\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    408\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    409\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    410\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m docs\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\langchain_community\\vectorstores\\faiss.py:304\u001b[0m, in \u001b[0;36mFAISS.similarity_search_with_score_by_vector\u001b[1;34m(self, embedding, k, filter, fetch_k, **kwargs)\u001b[0m\n\u001b[0;32m    302\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_normalize_L2:\n\u001b[0;32m    303\u001b[0m     faiss\u001b[38;5;241m.\u001b[39mnormalize_L2(vector)\n\u001b[1;32m--> 304\u001b[0m scores, indices \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mindex\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msearch\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvector\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mk\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mif\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;28;43mfilter\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01mis\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;28;43;01melse\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mfetch_k\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    305\u001b[0m docs \u001b[38;5;241m=\u001b[39m []\n\u001b[0;32m    307\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mfilter\u001b[39m \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\faiss\\class_wrappers.py:329\u001b[0m, in \u001b[0;36mhandle_Index.<locals>.replacement_search\u001b[1;34m(self, x, k, params, D, I)\u001b[0m\n\u001b[0;32m    327\u001b[0m n, d \u001b[38;5;241m=\u001b[39m x\u001b[38;5;241m.\u001b[39mshape\n\u001b[0;32m    328\u001b[0m x \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mascontiguousarray(x, dtype\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mfloat32\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m--> 329\u001b[0m \u001b[38;5;28;01massert\u001b[39;00m d \u001b[38;5;241m==\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39md\n\u001b[0;32m    331\u001b[0m \u001b[38;5;28;01massert\u001b[39;00m k \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m\n\u001b[0;32m    333\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m D \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n",
      "\u001b[1;31mAssertionError\u001b[0m: "
     ]
    }
   ],
   "source": [
    "retriever.get_relevant_documents(\"hello world\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "ac59ebe37160ed0dfa835113d9b8498d9f09ceb179beaac4002f036b9467c963"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
